define(["plugin-dependencies","common/utils/log","common/utils/templates","text!./view.html","css!./view.css"],function(e,i,t,s){return s=t.createTemplate(s),Backbone.View.extend({className:"cc-VersionMenu",events:{"click .cc-VersionMenu-cancel":"previewMenuCancel","click .cc-VersionMenu-restore":"previewMenuRestore"},initialize:function(){_.bindAll(this,"render","clearView","setResource","previewMenuRestore","previewMenuCancel")},render:function(){var i=this.model.get("_version"),t=this.model.getVersion(i).created,n=new Date(t);this.$el.html(s({translate:e.translate})),this.$(".cc-VersionMenu-restore").on("click",this.previewMenuRestore),this.$(".cc-VersionMenu-cancel").on("click",this.previewMenuCancel);var o=(e.utils.isToday(t)?"":e.utils.formatMonthDateAndYear(n)+" ")+e.utils.dateTimeAgoText(t);return this.$("h1 b").text(e.translate("Revised {0}",o)),this.delegateEvents(this.events),this},setResource:function(e){this.model=e},clearView:function(){this.remove()},previewMenuRestore:function(e){e.stopPropagation();var t=this;i("cca",{desc:"Revised Version",assetid:t.model.get("id"),reviseAction:"Restore"}),require(["files/dialogs/restore-version/dialog"],function(e){e.setItems([t.model]).show()})},previewMenuCancel:function(e){e.stopPropagation();var t=this;i("cca",{desc:"Revised Version",assetid:t.model.get("id"),reviseAction:"Cancel"}),this.model.set("_version",this.model.get("_versionHead")),this.clearView()}})});