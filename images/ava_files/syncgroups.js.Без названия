define(["underscore","common/model","./ccstorage-asset","./syncgroup","../config"],function(t,e,i,n,r){"use strict";var o=i(),s=t.pluck(r.apps,"syncgroup"),c=function(){var e=t.values(this.data),i=t.findWhere(e,{completed:!1});o.completed&&(this.empty||e.length&&!i)&&(this.completed=!0,this.trigger("completed"))},h=function(){for(var e={},i=o.get("children")||[],r=0;r<i.length;r++){var h=i[r].name;s.indexOf(h)>-1&&(e[h]=this.get(h)||n(h).init(),e[h].on("completed",c,this))}0===t.keys(e).length&&(g.empty=!0,g.completed=!0,g.trigger("changed"),g.trigger("completed")),this.setAll(e)},g={init:t.once(function(){return this.empty=!1,this.completed=!1,this.error=!1,o.init(),o.on("children.changed",h,this),o.on("completed",c,this),o.on("error",function(){this.trigger("error")},this),this}),getAll:function(){return this.init(),t.values(this.data)},getSyncGroup:function(t){var e=this.get(t);return e?e:(e=n(t).init(),this.set(t,e),e)}};return t.extend(g,e())});