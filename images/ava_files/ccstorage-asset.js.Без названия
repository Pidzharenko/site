define(["require","underscore","common/model","../config","../data"],function(t,e,r,s,i){"use strict";return function(t){var n=!1,o={init:function(t,r){return e.extend(this,e.findWhere(s.apps,{syncgroup:t})),this.path=r,this.location=i.url("assets/"+this.syncgroup+"/"+this.path),n=!0,this.completed=!1,this.error=!1,this.refresh(!0),this},refresh:function(t){if(n){t&&i.wipeAsset(this.syncgroup,this.path);var e=this;return e.completed=!1,e.error=!1,i.getAsset(this.syncgroup,this.path).then(function(t){return e.setAll(t)},function(t){e.error=!0,t&&403===t.status?i.events.trigger("access-denied"):e.trigger("error")}).always(function(){e.completed=!0,e.trigger("completed")})}throw new Error("Model not initialized")},save:function(){return i.updateAsset(this.syncgroup,this.path,this.data)},destroy:function(){var e=this;return i.deleteAsset(this.syncgroup,t.deletePath||this.path).then(function(){i.wipeAsset(e.syncgroup,e.path),e.setAll(void 0)})}};return e.extend(r(),o)}});